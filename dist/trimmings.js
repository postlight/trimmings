'use strict';(function(){var A=Object.freeze({key:"trimmingsAutosubmit",eventNames:["change"],handle:a=>{a=a.target;(a="FORM"===a.nodeName?a:a.closest("form"))&&a.submit()}});let n=(a,b,c)=>{c&&!a.classList.contains(b)?a.classList.add(b):!c&&a.classList.contains(b)&&a.classList.remove(b)},f="",p="";var C=Object.freeze({key:"trimmingsToggle",eventNames:["click","input","change"],render:a=>{const {pathname:b,search:c,hash:d}=window.location;f=`${b}${c}`;p=d;Array.prototype.forEach.call(a.querySelectorAll("a"),
a=>{var b=a.getAttribute("href");var c=0!==b.indexOf(f)?!1:b.length!==f.length&&"#"!==b.substring(f.length,f.length+1)?!1:!0;var d;if(d=c)d=p.match(/^#?$/)?-1===b.indexOf("#")||b.match(/#$/):-1===b.indexOf("#")?!1:`#${b.split("#")[1]}`===p;b=d;n(a,"trimmings-current",c);n(a,"trimmings-current--fragment",b)})}});let l=(a,b={})=>window.fetch(a,b).then(a=>a.text()).then(a=>{const b=document.createElement("html");b.innerHTML=a;return b});var D=Object.freeze({key:"trimmingsToggle",eventNames:["click",
"input","change"],render:a=>{Array.prototype.forEach.call(a.querySelectorAll("a[data-trimmings-embed]"),a=>{if("none"!==window.getComputedStyle(a).display&&!a.classList.contains("trimmings-loading")&&a.parentNode&&a.getAttribute("href")){var b=a.dataset.trimmingsEmbed||"body";a.classList.add("trimmings-loading");l(a.getAttribute("href")).then(c=>{const d=c.querySelector(b);c?a.parentNode.replaceChild(d,a):a.classList.remove("trimmings-loading")})}})}}),E=Object.freeze({key:"trimmingsToggle",eventNames:["click",
"input","change"],render:()=>{document.body&&!document.body.classList.contains("trimmings")&&document.body.classList.add("trimmings")}}),F=Object.freeze({listen:()=>{window.addEventListener("keydown",a=>{a=[a.altKey?"Alt":null,a.ctrlKey?"Control":null,a.metaKey?"Meta":null,a.shiftKey?"Shift":null,a.code.match(/Alt|Shift|Control|Meta/)?null:a.code].filter(Boolean).join("+");(a=document.querySelector(`[data-trimmings-hotkey~="${a}"]`))&&a.click()})}});let q=a=>!(a.target&&a.target.isContentEditable||
a.defaultPrevented||1<a.which||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey),v=a=>{const b=[];Array.prototype.forEach.call(a,a=>{!a.disabled&&a.name&&a.value&&(!["checkbox","radio"].includes(a.type)||a.checked)&&/^(?:input|select|textarea|keygen)/i.test(a.nodeName)&&!/^(?:submit|button|image|reset|file)$/i.test(a.type)&&("select-multiple"===a.type?Array.prototype.filter.call(a.options,a=>a.selected&&a.value).forEach(c=>{b.push([a.name,c.value])}):b.push([a.name,a.value]))});return b.map(([a,b])=>`${encodeURIComponent(a)}=${encodeURIComponent(b.replace(/(\r)?\n/g,
"\r\n")).replace(/%20/g,"+")}`).join("&")},w=a=>{if("A"===a.nodeName)return a.getAttribute("href");if("FORM"===a.nodeName){const b=a.getAttribute("action"),c=a.getAttribute("method");return c&&"get"!==c.toLowerCase()?b:(a=v(a),`${b}?${a}`)}},G={"Content-Type":"application/x-www-form-urlencoded"},x=a=>{const b=w(a);if("A"===a.nodeName)return l(b);if("FORM"===a.nodeName){const c=a.getAttribute("method");if(!c||"get"===c.toLowerCase())return l(b);a=v(a);return l(b,{method:c,body:a,headers:G})}throw Error(`Unexpected nodename ${a.nodeName} for loadElement`);
},t=a=>{const b=[],c={};a.trim().split(/\s*,\s*/g).forEach(a=>{if(-1<a.indexOf(":")){const [b,d]=a.split(/\s*:\s*/);c[b]=d}else b.push(a)});return{args:b,options:c}},r=(a,b,c)=>{b.removeAttribute("data-trimmings-inline");a[c]()},y=()=>{const {content:a,tag:b,title:c}=window.history.state;c&&(document.title=c);const d=document.querySelector(`[data-trimmings-location-tag="${b}"]`);d&&d.innerHTML!==a&&(d.innerHTML=a)};var H=Object.freeze({key:"trimmingsInline",eventNames:["submit","click"],listen:()=>
{window.addEventListener("popstate",y)},handle:a=>{if("click"!==a.type||q(a)){var b=a.target,c=b;"undefined"===typeof c.dataset.trimmingsInline&&(c=a.target.closest("[data-trimmings-inline]"));if("true"===c.dataset.trimmingsDisableInline)return!0;var d=a.type,{options:g}=t(c.dataset.trimmingsInline),{from:B,to:k,method:f="replace",template:l,updateLocation:m,updateTitle:n}=g,e=document.querySelector(k);if(!e||"none"===window.getComputedStyle(e).display)return!0;a.preventDefault();if(c.classList.contains("trimmings-loading"))return!1;
var p=e.innerHTML;c.classList.add("trimmings-loading");x(c).then(a=>{var h=a.querySelector(B);if(h){if(l){var g=document.querySelector(l);if(!g){r(b,c,d);return}var k=document.createElement("div");k.innerHTML=g.innerHTML;g=k.querySelector("[data-trimmings-inline-target]");if(!g){r(b,c,d);return}g.parentNode.replaceChild(h,g);h=document.createDocumentFragment();h.innerHTML=k.innerHTML}0===f.indexOf("reduce")&&(Array.prototype.forEach.call(e.children,a=>{a.dataset.trimmingsChild="true"}),(k=c.closest("[data-trimmings-child]"))&&
k.removeAttribute("data-trimmings-child"),Array.prototype.forEach.call(e.querySelectorAll("[data-trimmings-child]"),a=>{a.parentNode.removeChild(a)}));switch(f){case "replace":e.innerHTML=h instanceof window.DocumentFragment?h.innerHTML:h.outerHTML;break;case "reduce-prepend":case "prepend":e.hasChildNodes()?e.insertBefore(h,e.firstChild):e.appendChild(h);break;case "reduce-append":case "append":e.appendChild(h);break;default:r(b,c,d)}a="true"===n?a.querySelector("title").innerHTML:null;"true"===
m&&(e.dataset.trimmingsLocationTag=e.dataset.trimmingsLocationTag||Math.random().toString(),window.history.replaceState({title:document.title,tag:e.dataset.trimmingsLocationTag,content:p},null,window.location.href),window.history.pushState({title:a||document.title,tag:e.dataset.trimmingsLocationTag,content:e.innerHTML},null,w(c)),y());a&&(document.title=a);c.classList.remove("trimmings-loading")}else r(b,c,d)})}}}),I=Object.freeze({key:"trimmingsRemove",eventNames:["click"],handle:a=>{("click"!==
a.type||q(a))&&(a=document.querySelector(a.target.dataset.trimmingsRemove))&&a.parentNode&&a.parentNode.removeChild(a)}}),J=Object.freeze({key:"trimmingsReplace",eventNames:["submit","click"],handle:a=>{if("click"!==a.type||q(a)){a.preventDefault();a=a.target;var b=t(a.dataset.trimmingsReplace).args;x(a).then(a=>{b.forEach(b=>{const c=a.querySelector(b);(b=document.querySelector(b))&&b.parentNode&&b.parentNode.replaceChild(c,b)})})}}}),K=Object.freeze({key:"trimmingsToggle",eventNames:["click","input",
"change"],handle:a=>{const b=a.target,[c,d]=t(b.dataset.trimmingsToggle).args,g=document.querySelector(c);if(g){var f=null;if("BUTTON"===b.nodeName){if("click"===a.type&&!q(a))return;f=!g.classList.contains(d)}else"INPUT"===b.nodeName&&(a=b.getAttribute("type"),["radio","checkbox"].includes(a)?(f=b.checked,"radio"===a&&("true"===b.dataset.trimmingsChainToggle?b.dataset.trimmingsChainToggle=null:(a=b.getAttribute("name"),a=document.querySelectorAll(`input[type="radio"][name="${a}"]`),Array.prototype.forEach.call(a,
a=>{a!==b&&(a.dataset.trimmingsChainToggle="true",a.dispatchEvent(new window.Event("change",{bubbles:!0}),!0))})))):f=0<(b.value||"").toString().length);n(g,d,f)}}}),u={autosubmit:A,current:C,embed:D,enabled:E,hotkeys:F,inline:H,remove:I,replace:J,toggle:K};let L=Object.values(u).filter(a=>"function"===typeof a.render).map(a=>a.render),m=a=>{L.forEach(b=>{b(a)})},M=()=>{(new window.MutationObserver(a=>{a.forEach(a=>{"attributes"===a.type&&-1<Object.keys(a.target.dataset).join(",").indexOf("trimmings")?
m(a.target.parentNode||a.target):"childList"===a.type&&m(a.target)})})).observe(document.querySelector("body"),{attributes:!0,childList:!0,subtree:!0})},N=(a,b)=>-1===b.join(",").indexOf("trimmings")?"click"===a.type&&a.target.closest("[data-trimmings-inline]")?{keys:["trimmingsInline"]}:["change","input"].includes(a.type)&&(a=a.target.closest("form"))&&"undefined"!==typeof a.dataset.trimmingsAutosubmit?{keys:["trimmingsAutosubmit"]}:null:{keys:b},z=Object.values(u).filter(a=>a.key&&a.eventNames&&
a.handle).map(a=>({key:a.key,eventNames:a.eventNames,handle:a.handle}));window.addEventListener("DOMContentLoaded",()=>{Object.values(u).filter(a=>"function"===typeof a.listen).forEach(a=>{a.listen()});M();m(document);[[window,"DOMContentLoaded"],[document,"turbolinks:render"],[window,"hashchange"],[window,"popstate"],[window,"pushstate"],[window,"onorientationchange"]].forEach(([a,c])=>{a.addEventListener(c,()=>{m(document)})});const a=a=>{const b=Object.keys(a.target.dataset),d=N(a,b);if(!d)return!0;
z.forEach(({key:b,eventNames:c,handle:f})=>{d.keys.includes(b)&&c.includes(a.type)&&f(a)})};z.reduce((a,c)=>a.concat(c.eventNames),[]).filter((a,c,d)=>d.indexOf(a)===c).forEach(b=>{document.addEventListener(b,a)})})})();
